#!/bin/sh
#
# STARSpan project
# Carlos A. Rueda
# starspan - launcher script
# NOTE: Adjust as necessary for your environment
# $Id$
#

BINDIR=`dirname $0`

# The proper starspan binary:
STARSPAN2=$BINDIR/starspan2

# $JARS: the following jars should be present under this directory:
#
# Required by the --view_geometries option:
#      plotapplication.jar
# Can be download from http://ptolemy.eecs.berkeley.edu/java/ptplot
# Currently the version 5.1p2 is used.
#
# Required by the --test and --jts options:
#      xerces.jar
#      jts-1.4.0.jar
#      jdom.jar
#      JTS_Test.jar
#      Acme.jar
# These can be downloaded from http://www.vividsolutions.com/jts/jtshome.htm 
# Currently JTS 1.4 is used.
#
JARS=$BINDIR/starspan.jars/

if [ "`uname -n`" == "px" ]; then
	# my machine :-)
	export LD_LIBRARY_PATH=$BINDIR/../lib:/usr/local/lib:$LD_LIBRARY_PATH
else
	# cstars machines
	export LD_LIBRARY_PATH=/proj/delta/delta_2004/code/starspan/usr_local/lib:$LD_LIBRARY_PATH
fi

function usage() {
	cat << EOF

starspan extended usage:

    starspan --view_geometries dumped_geometries.csv
        launches the ptPlot application with the given file.
        Normally dumped_geometries.csv was generated by 
		"starspan -dump_geometries dumped_geometries.csv ..."
            
    starspan --test args...
        launches the JTS Test Runner
        Typically this is called:
            starspan --test -files a_test.xml
        where a_test.xml was generated by "starspan -jtstest a_test.xml ..."
            
    starspan --jts
        launches the JTS Test Builder as a way to visualize the
        geometries involved in tests.
        Choose "File->Open XML file(s)..." to open an .xml file
        generated by "starspan -jtstest ..."

EOF
	return;
}

if [ "$1" == "-xhelp" ]; then
	usage
	exit

elif [ "$1" == "--view_geometries" ]; then
	echo "[Launching ptplot...]"
	shift
	CP=$CLASSPATH
	CP=$JARS/plotapplication.jar:$CP
	java -Xmx256m -cp $CP ptolemy.plot.PlotApplication $*

elif [ "$1" == "--test" ]; then
	echo "[Launching JTS TopologyTestApp...]"
	shift
	CP=$CLASSPATH
	for i in $JARS/*.jar; do CP=$i:$CP; done
	java -Xmx256m -cp $CP com.vividsolutions.jtstest.testrunner.TopologyTestApp $*

elif [ "$1" == "--jts" ]; then
	echo "[Launching JTSTestBuilder...]"
	shift
	CP=$CLASSPATH
	for i in $JARS/*.jar; do CP=$i:$CP; done
	java -Xmx256m -cp $CP com.vividsolutions.jtstest.testbuilder.JTSTestBuilder $*

else
	# call starspan2
	$STARSPAN2 $*
fi

